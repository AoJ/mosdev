<!DOCTYPE html>
<html>
<head>
    <title>Simple grid</title>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script>
    <script type="text/javascript" src="../lib/jquery.tmpl/jquery.tmpl.js"></script>
    <script type="text/javascript" src="../lib/knockout/knockout-latest.debug.js"></script>
    <script type="text/javascript" src="../src/namespace.js"></script>
    <script type="text/javascript" src="../src/class.js"></script>
    <script type="text/javascript" src="../src/grid/grid.js"></script>
    <script type="text/javascript" src="../src/grid/bindingHandler.js"></script>
    <script type="text/javascript">
        $(document).ready(function() {
            /**
             * Create a new grid model
             */
            var model = new mos.grid();

            /**
             * Define a dataset
             */
            var people = [
                { name: ko.observable("Alice Anderson"), address: ko.observable("1 Zorba Avenue") },
                { name: ko.observable("Bill Boss"), address: ko.observable("65 Oak Drive") }
            ];

            /**
             * Add every person to the model
             */
            ko.utils.arrayForEach(people, function(person) {
                model.rows.push(person);
            })

            /**
             * Add the "name" column
             */
            model.columns.push(new mos.grid.column({
                title: "Name",
                property: "name"
            }));

            /**
             * Add the "address" column
             */
            model.columns.push(new mos.grid.column({
                title: "Address",
                property: "address"
            }));

            var updateGrid = function() {
                people[0].name("Charlie Changed");
                model.columns()[0].title("Boo!");
            };

            /**
             * Sprinkle magic binding dust
             */
            ko.applyBindings({
                model: model,
                updateGrid: updateGrid
            });
        });
    </script>

    <!-- The main grid template -->
    <script type="text/html" id="gridTemplate">
        <table>
            <thead>
            <tr data-bind="template: { name: 'gridHeaderColumnTemplate', foreach: columns }">
            </tr>
            </thead>
            <tbody data-bind="template: { name: 'gridRowTemplate', foreach: displayRows }">
            </tbody>
        </table>
    </script>

    <!-- The template for every grid header -->
    <script type="text/html" id="gridHeaderColumnTemplate">
        <th>{{= title }}</th>
    </script>

    <!-- The template for every row -->
    <script type="text/html" id="gridRowTemplate">
        <tr data-bind="template: { name: 'gridCellTemplate', foreach: $data }">
        </tr>
    </script>

    <!-- The template for every cell in a row -->
    <script type="text/html" id="gridCellTemplate">
        <td>{{= displayValue }}</td>
    </script>
</head>
<body>
    <div data-bind="grid: model"></div>
    <input type="button" data-bind="click: updateGrid" value="Change some things">
</body>
</html>